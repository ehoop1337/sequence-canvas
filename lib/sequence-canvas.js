var SequenceCanvas;(()=>{"use strict";var i={d:(t,s)=>{for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})},o:(i,t)=>Object.prototype.hasOwnProperty.call(i,t)},t={};(()=>{i.d(t,{default:()=>h});var s,e=function(i,t,s,e){if("a"===s&&!e)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?i!==t||!e:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?e:"a"===s?e.call(i):e?e.value:t.get(i)};s=new WeakMap;const h=class{constructor(i){var t,h,a,n,o,d,r,g,m,v,l,I,u,c,p,x,w,f,y,C,b,T,E,P,L,z,S,R,A,D,O,F,q,j,B,W,k,G,M;this.canvas=void 0,this.context=void 0,this.heightCanvas=void 0,this.widthCanvas=void 0,this.images=void 0,this.isPositionImages=void 0,this.xPosImages=void 0,this.yPosImages=void 0,this.isSizeImages=void 0,this.widthImages=void 0,this.heightImages=void 0,this.isTrimImages=void 0,this.xTrimImages=void 0,this.yTrimImages=void 0,this.widthTrimImages=void 0,this.heightTrimImages=void 0,this.fps=void 0,this.direction=void 0,this.loop=void 0,this.startIndex=void 0,this.finishIndex=void 0,this.currentIndex=void 0,this.startImmediately=void 0,this.startAfterLoaded=void 0,this.initiate=!1,this.logging=!1,this.rendering=!1,this.events={init:new CustomEvent("init",{bubbles:!0}),load:new CustomEvent("load",{bubbles:!0}),loaded:new CustomEvent("loaded",{bubbles:!0}),render:new CustomEvent("render",{bubbles:!0}),start:new CustomEvent("start",{bubbles:!0}),play:new CustomEvent("play",{bubbles:!0}),stop:new CustomEvent("stop",{bubbles:!0}),pause:new CustomEvent("pause",{bubbles:!0})},s.set(this,(()=>{this.rendering?(this.requestId=requestAnimationFrame(e(this,s,"f")),this.now=Date.now(),this.elapsed=this.now-this.then,this.elapsed>this.fpsInterval&&(this.then=this.now-this.elapsed%this.fpsInterval,this.logic())):this.requestId&&cancelAnimationFrame(this.requestId)})),this.addListenersBeforeInitialization=i=>{if(i)for(let t in i)this.canvas.addEventListener(t,i[t].bind(this))},this.canvas=i.canvas.element,this.context=this.canvas.getContext("2d"),this.widthCanvas=i.canvas.width,this.heightCanvas=i.canvas.height,this.images=i.images.paths.map((i=>({path:i,state:"WAIT"}))),this.isPositionImages=void 0!==(null===(h=null===(t=i.images)||void 0===t?void 0:t.options)||void 0===h?void 0:h.position),this.xPosImages=null===(o=null===(n=null===(a=i.images)||void 0===a?void 0:a.options)||void 0===n?void 0:n.position)||void 0===o?void 0:o.x,this.yPosImages=null===(g=null===(r=null===(d=i.images)||void 0===d?void 0:d.options)||void 0===r?void 0:r.position)||void 0===g?void 0:g.y,this.isSizeImages=void 0!==(null===(v=null===(m=i.images)||void 0===m?void 0:m.options)||void 0===v?void 0:v.size),this.widthImages=null===(u=null===(I=null===(l=i.images)||void 0===l?void 0:l.options)||void 0===I?void 0:I.size)||void 0===u?void 0:u.width,this.heightImages=null===(x=null===(p=null===(c=i.images)||void 0===c?void 0:c.options)||void 0===p?void 0:p.size)||void 0===x?void 0:x.height,this.isTrimImages=void 0!==(null===(f=null===(w=i.images)||void 0===w?void 0:w.options)||void 0===f?void 0:f.trim),this.xTrimImages=null===(b=null===(C=null===(y=i.images)||void 0===y?void 0:y.options)||void 0===C?void 0:C.trim)||void 0===b?void 0:b.x,this.yTrimImages=null===(P=null===(E=null===(T=i.images)||void 0===T?void 0:T.options)||void 0===E?void 0:E.trim)||void 0===P?void 0:P.y,this.widthTrimImages=null===(S=null===(z=null===(L=i.images)||void 0===L?void 0:L.options)||void 0===z?void 0:z.trim)||void 0===S?void 0:S.width,this.heightTrimImages=null===(D=null===(A=null===(R=i.images)||void 0===R?void 0:R.options)||void 0===A?void 0:A.trim)||void 0===D?void 0:D.height,this.fps="number"==typeof i.fps&&60>=i.fps&&i.fps>0?i.fps:60,this.direction=null!==(O=i.direction)&&void 0!==O?O:1,this.loop=null===(F=i.loop)||void 0===F||F,this.startIndex=null!==(q=i.startIndex)&&void 0!==q?q:0,this.finishIndex=null!==(j=i.finishIndex)&&void 0!==j?j:i.images.paths.length?i.images.paths.length-1:0,this.currentIndex=null!==(B=i.currentIndex)&&void 0!==B?B:0,this.startImmediately=null!==(W=i.startImmediately)&&void 0!==W&&W,this.startAfterLoaded=null===(k=i.startAfterLoaded)||void 0===k||k,this.initiate=null===(G=i.init)||void 0===G||G,this.logging=null!==(M=i.logging)&&void 0!==M&&M,i.on&&this.addListenersBeforeInitialization(i.on),this.initiate&&this.init()}loadImage(i){this.images[i].state="LOADING",this.canvas.dispatchEvent(this.events.load);const t=new Image;t.src=this.images[i].path,t.onload=()=>{this.images[i].state="LOADED",this.images[i].image=t,this.canvas.dispatchEvent(this.events.loaded),!this.rendering&&(this.startImmediately||this.startAfterLoaded&&this.isLoadedFrames())&&(this.currentIndex===this.startIndex?this.start():this.play())},t.onerror=()=>{this.images[i].state="ERROR"}}setRendering(i){this.rendering=i}startRender(){this.setRendering(!0),this.drawImage(this.currentIndex),this.fpsInterval=1e3/this.fps,this.then=Date.now(),this.startTime=this.then,e(this,s,"f").call(this)}logic(){this.direction>0?this.loop?this.currentIndex===this.finishIndex?this.setCurrentImage(this.startIndex):this.setCurrentImage(this.currentIndex+1):this.currentIndex===this.finishIndex?this.setRendering(!1):this.setCurrentImage(this.currentIndex+1):this.loop?this.currentIndex===this.startIndex?this.setCurrentImage(this.finishIndex):this.setCurrentImage(this.currentIndex-1):this.currentIndex===this.startIndex?this.setRendering(!1):this.setCurrentImage(this.currentIndex-1),this.drawImage(this.currentIndex)}drawImage(i){if("LOADED"===this.images[i].state&&this.images[i].image){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.logging&&console.log("rendered:",i,this.images[i]),this.canvas.dispatchEvent(this.events.render),this.isTrimImages){if(this.isSizeImages&&this.isPositionImages)return void this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthTrimImages,this.heightTrimImages,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages);if(this.isSizeImages)return void this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthTrimImages,this.heightTrimImages,0,0,this.widthImages,this.heightImages);this.isPositionImages?this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthCanvas,this.heightCanvas,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages):this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthCanvas,this.heightCanvas,0,0,this.widthImages,this.heightImages)}if(this.isSizeImages)return this.isPositionImages?void this.context.drawImage(this.images[i].image,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages):void this.context.drawImage(this.images[i].image,0,0,this.widthImages,this.heightImages);this.isPositionImages?this.context.drawImage(this.images[i].image,this.xPosImages,this.yPosImages):this.context.drawImage(this.images[i].image,0,0)}else this.logging&&console.log("not rendered",i,this.images[i])}init(){this.canvas.dispatchEvent(this.events.init),this.setSizesCanvas({width:this.widthCanvas,height:this.heightCanvas}),this.images.forEach(((i,t)=>{this.loadImage(t)}))}isLoadedFrames(){return this.images.every((i=>"LOADED"===i.state))}start(){this.currentIndex=this.startIndex,this.canvas.dispatchEvent(this.events.start),this.startRender()}play(){this.canvas.dispatchEvent(this.events.play),this.startRender()}stop(){this.canvas.dispatchEvent(this.events.stop),this.setRendering(!1),this.setCurrentImage(this.startIndex)}pause(){this.canvas.dispatchEvent(this.events.pause),this.setRendering(!1)}on(i,t){this.canvas.addEventListener(i,t.bind(this))}off(i,t){this.canvas.removeEventListener(i,t.bind(this))}setCurrentImage(i){this.currentIndex=i}getCurrentImage(){return this.currentIndex}setSizesCanvas(i){i.width?(this.canvas.width=i.width,this.widthCanvas=i.width):this.widthCanvas=this.canvas.width,i.height?(this.canvas.height=i.height,this.heightCanvas=i.height):this.heightCanvas=this.canvas.height}getSizesCanvas(){return{width:this.widthCanvas,height:this.heightCanvas}}setImageOptions(i){var t,s,e,h,a,n,o,d;this.isPositionImages=void 0!==(null==i?void 0:i.position),this.xPosImages=null===(t=i.position)||void 0===t?void 0:t.x,this.yPosImages=null===(s=i.position)||void 0===s?void 0:s.y,this.isSizeImages=void 0!==(null==i?void 0:i.size),this.widthImages=null===(e=i.size)||void 0===e?void 0:e.width,this.heightImages=null===(h=i.size)||void 0===h?void 0:h.height,this.isTrimImages=void 0!==(null==i?void 0:i.trim),this.xTrimImages=null===(a=i.trim)||void 0===a?void 0:a.x,this.yTrimImages=null===(n=i.trim)||void 0===n?void 0:n.y,this.widthTrimImages=null===(o=i.trim)||void 0===o?void 0:o.width,this.heightTrimImages=null===(d=i.trim)||void 0===d?void 0:d.height}getImageSettings(){return{position:{x:this.xPosImages,y:this.yPosImages},trim:{x:this.xTrimImages,y:this.yTrimImages,width:this.widthTrimImages,height:this.heightTrimImages},size:{width:this.widthImages,height:this.heightImages}}}setFps(i){this.fps="number"==typeof i&&60>=i&&i>0?i:60}getFps(){return this.fps}setDirection(i){this.direction=i}getDirection(){return this.direction}setLoop(i){this.loop=i}getLoop(){return this.loop}setStartIndex(i){i>this.images.length?this.startIndex=this.images.length:this.startIndex=i<0?0:i}getStartIndex(){return this.startIndex}setFinishIndex(i){i>this.images.length?this.finishIndex=this.images.length:this.finishIndex=i<0?0:i}getFinishIndex(){return this.finishIndex}enableLogging(){this.logging=!0}disableLogging(){this.logging=!1}getLogging(){return this.logging}}})(),SequenceCanvas=t.default})();
//# sourceMappingURL=sequence-canvas.js.map