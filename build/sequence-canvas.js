var SequenceCanvas;(()=>{"use strict";var i={};({771:function(i,t){var s,e=this&&this.__classPrivateFieldGet||function(i,t,s,e){if("a"===s&&!e)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?i!==t||!e:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?e:"a"===s?e.call(i):e?e.value:t.get(i)};Object.defineProperty(t,"__esModule",{value:!0}),s=new WeakMap,t.default=class{constructor(i){var t,h,n,a,o,d,r,g,m,v,l,I,u,c,p,w,x,f,C,y,b,T,E,P,L,z,R,S,D,A,F,q,O,_,j,B,G,M,W,k,N,H,J;this.initiate=!1,this.logging=!1,this.rendering=!1,this.requestId=0,this.fpsInterval=0,this.now=0,this.then=0,this.startTime=0,this.elapsed=0,this.events={init:new CustomEvent("init",{bubbles:!0}),load:new CustomEvent("load",{bubbles:!0}),loaded:new CustomEvent("loaded",{bubbles:!0}),render:new CustomEvent("render",{bubbles:!0}),start:new CustomEvent("start",{bubbles:!0}),play:new CustomEvent("play",{bubbles:!0}),stop:new CustomEvent("stop",{bubbles:!0}),pause:new CustomEvent("pause",{bubbles:!0})},s.set(this,(()=>{this.rendering?(this.requestId=requestAnimationFrame(e(this,s,"f")),this.now=Date.now(),this.elapsed=this.now-this.then,this.elapsed>this.fpsInterval&&(this.then=this.now-this.elapsed%this.fpsInterval,this.logic())):this.requestId&&cancelAnimationFrame(this.requestId)})),this.addListenersBeforeInitialization=i=>{if(i)for(let t in i)this.canvas.addEventListener(t,i[t].bind(this))},this.canvas=i.canvas.element,this.context=this.canvas.getContext("2d"),this.widthCanvas=null!==(h=null===(t=i.canvas)||void 0===t?void 0:t.width)&&void 0!==h?h:this.canvas.width,this.heightCanvas=null!==(a=null===(n=i.canvas)||void 0===n?void 0:n.height)&&void 0!==a?a:this.canvas.height,this.images=i.images.paths.map((i=>({path:i,state:"WAIT"}))),this.isPositionImages=void 0!==(null===(d=null===(o=i.images)||void 0===o?void 0:o.options)||void 0===d?void 0:d.position),this.xPosImages=null===(m=null===(g=null===(r=i.images)||void 0===r?void 0:r.options)||void 0===g?void 0:g.position)||void 0===m?void 0:m.x,this.yPosImages=null===(I=null===(l=null===(v=i.images)||void 0===v?void 0:v.options)||void 0===l?void 0:l.position)||void 0===I?void 0:I.y,this.isSizeImages=void 0!==(null===(c=null===(u=i.images)||void 0===u?void 0:u.options)||void 0===c?void 0:c.size),this.widthImages=null===(x=null===(w=null===(p=i.images)||void 0===p?void 0:p.options)||void 0===w?void 0:w.size)||void 0===x?void 0:x.width,this.heightImages=null===(y=null===(C=null===(f=i.images)||void 0===f?void 0:f.options)||void 0===C?void 0:C.size)||void 0===y?void 0:y.height,this.isTrimImages=void 0!==(null===(T=null===(b=i.images)||void 0===b?void 0:b.options)||void 0===T?void 0:T.trim),this.xTrimImages=null===(L=null===(P=null===(E=i.images)||void 0===E?void 0:E.options)||void 0===P?void 0:P.trim)||void 0===L?void 0:L.x,this.yTrimImages=null===(S=null===(R=null===(z=i.images)||void 0===z?void 0:z.options)||void 0===R?void 0:R.trim)||void 0===S?void 0:S.y,this.widthTrimImages=null===(F=null===(A=null===(D=i.images)||void 0===D?void 0:D.options)||void 0===A?void 0:A.trim)||void 0===F?void 0:F.width,this.heightTrimImages=null===(_=null===(O=null===(q=i.images)||void 0===q?void 0:q.options)||void 0===O?void 0:O.trim)||void 0===_?void 0:_.height,this.fps="number"==typeof i.fps&&60>=i.fps&&i.fps>0?i.fps:60,this.direction=null!==(j=i.direction)&&void 0!==j?j:1,this.loop=null===(B=i.loop)||void 0===B||B,this.startIndex=null!==(G=i.startIndex)&&void 0!==G?G:0,this.finishIndex=null!==(M=i.finishIndex)&&void 0!==M?M:i.images.paths.length?i.images.paths.length-1:0,this.currentIndex=null!==(W=i.currentIndex)&&void 0!==W?W:0,this.startImmediately=null!==(k=i.startImmediately)&&void 0!==k&&k,this.startAfterLoaded=null===(N=i.startAfterLoaded)||void 0===N||N,this.initiate=null===(H=i.init)||void 0===H||H,this.logging=null!==(J=i.logging)&&void 0!==J&&J,i.on&&this.addListenersBeforeInitialization(i.on),this.initiate&&this.init()}loadImage(i){this.images[i].state="LOADING",this.canvas.dispatchEvent(this.events.load);const t=new Image;t.src=this.images[i].path,t.onload=()=>{this.images[i].state="LOADED",this.images[i].image=t,this.canvas.dispatchEvent(this.events.loaded),!this.rendering&&(this.startImmediately||this.startAfterLoaded&&this.isLoadedFrames())&&(this.currentIndex===this.startIndex?this.start():this.play())},t.onerror=()=>{this.images[i].state="ERROR"}}setRendering(i){this.rendering=i}startRender(){this.setRendering(!0),this.drawImage(this.currentIndex),this.fpsInterval=1e3/this.fps,this.then=Date.now(),this.startTime=this.then,e(this,s,"f").call(this)}logic(){this.direction>0?this.loop?this.currentIndex===this.finishIndex?this.setCurrentImage(this.startIndex):this.setCurrentImage(this.currentIndex+1):this.currentIndex===this.finishIndex?this.setRendering(!1):this.setCurrentImage(this.currentIndex+1):this.loop?this.currentIndex===this.startIndex?this.setCurrentImage(this.finishIndex):this.setCurrentImage(this.currentIndex-1):this.currentIndex===this.startIndex?this.setRendering(!1):this.setCurrentImage(this.currentIndex-1),this.drawImage(this.currentIndex)}drawImage(i){if("LOADED"===this.images[i].state&&this.images[i].image){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.logging&&console.log("rendered:",i,this.images[i]),this.canvas.dispatchEvent(this.events.render),this.isTrimImages){if(this.isSizeImages&&this.isPositionImages)return void this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthTrimImages,this.heightTrimImages,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages);if(this.isSizeImages)return void this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthTrimImages,this.heightTrimImages,0,0,this.widthImages,this.heightImages);this.isPositionImages?this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthCanvas,this.heightCanvas,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages):this.context.drawImage(this.images[i].image,this.xTrimImages,this.yTrimImages,this.widthCanvas,this.heightCanvas,0,0,this.widthImages,this.heightImages)}if(this.isSizeImages)return this.isPositionImages?void this.context.drawImage(this.images[i].image,this.xPosImages,this.yPosImages,this.widthImages,this.heightImages):void this.context.drawImage(this.images[i].image,0,0,this.widthImages,this.heightImages);this.isPositionImages?this.context.drawImage(this.images[i].image,this.xPosImages,this.yPosImages):this.context.drawImage(this.images[i].image,0,0)}else this.logging&&console.log("not rendered",i,this.images[i])}init(){this.canvas.dispatchEvent(this.events.init),this.setSizesCanvas({width:this.widthCanvas,height:this.heightCanvas}),this.images.forEach(((i,t)=>{this.loadImage(t)}))}isLoadedFrames(){return this.images.every((i=>"LOADED"===i.state))}start(){this.currentIndex=this.startIndex,this.canvas.dispatchEvent(this.events.start),this.startRender()}play(){this.canvas.dispatchEvent(this.events.play),this.startRender()}stop(){this.canvas.dispatchEvent(this.events.stop),this.setRendering(!1),this.setCurrentImage(this.startIndex),this.drawImage(this.startIndex)}pause(){this.canvas.dispatchEvent(this.events.pause),this.setRendering(!1)}on(i,t){this.canvas.addEventListener(i,t.bind(this))}off(i,t){this.canvas.removeEventListener(i,t.bind(this))}setCurrentImage(i){this.currentIndex=i}getCurrentImage(){return this.currentIndex}setSizesCanvas(i){i.width?(this.canvas.width=i.width,this.widthCanvas=i.width):this.widthCanvas=this.canvas.width,i.height?(this.canvas.height=i.height,this.heightCanvas=i.height):this.heightCanvas=this.canvas.height}getSizesCanvas(){return{width:this.widthCanvas,height:this.heightCanvas}}setImageOptions(i){var t,s,e,h,n,a,o,d;this.isPositionImages=void 0!==(null==i?void 0:i.position),this.xPosImages=null===(t=i.position)||void 0===t?void 0:t.x,this.yPosImages=null===(s=i.position)||void 0===s?void 0:s.y,this.isSizeImages=void 0!==(null==i?void 0:i.size),this.widthImages=null===(e=i.size)||void 0===e?void 0:e.width,this.heightImages=null===(h=i.size)||void 0===h?void 0:h.height,this.isTrimImages=void 0!==(null==i?void 0:i.trim),this.xTrimImages=null===(n=i.trim)||void 0===n?void 0:n.x,this.yTrimImages=null===(a=i.trim)||void 0===a?void 0:a.y,this.widthTrimImages=null===(o=i.trim)||void 0===o?void 0:o.width,this.heightTrimImages=null===(d=i.trim)||void 0===d?void 0:d.height}getImageSettings(){return{position:{x:this.xPosImages,y:this.yPosImages},trim:{x:this.xTrimImages,y:this.yTrimImages,width:this.widthTrimImages,height:this.heightTrimImages},size:{width:this.widthImages,height:this.heightImages}}}setFps(i){this.fps=60>=i&&i>0?i:60}getFps(){return this.fps}setDirection(i){this.direction=i}getDirection(){return this.direction}setLoop(i){this.loop=i}getLoop(){return this.loop}setStartIndex(i){i>this.images.length?this.startIndex=this.images.length:this.startIndex=i<0?0:i}getStartIndex(){return this.startIndex}setFinishIndex(i){i>this.images.length?this.finishIndex=this.images.length:this.finishIndex=i<0?0:i}getFinishIndex(){return this.finishIndex}enableLogging(){this.logging=!0}disableLogging(){this.logging=!1}getLogging(){return this.logging}}}})[771](0,i),SequenceCanvas=i.default})();
//# sourceMappingURL=sequence-canvas.js.map